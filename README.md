# ansible_cucm_cop_file_installer

[![forthebadge](https://forthebadge.com/images/badges/made-with-python.svg)](https://forthebadge.com) [![forthebadge](data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMDYuNDciIGhlaWdodD0iMzUiIHZpZXdCb3g9IjAgMCAyMDYuNDcgMzUiPjxyZWN0IGNsYXNzPSJzdmdfX3JlY3QiIHg9IjAiIHk9IjAiIHdpZHRoPSIxMDYuMzMiIGhlaWdodD0iMzUiIGZpbGw9IiMzMUM0RjMiLz48cmVjdCBjbGFzcz0ic3ZnX19yZWN0IiB4PSIxMDQuMzMiIHk9IjAiIHdpZHRoPSIxMDIuMTQiIGhlaWdodD0iMzUiIGZpbGw9IiNDMTNCM0EiLz48cGF0aCBjbGFzcz0ic3ZnX190ZXh0IiBkPSJNMTUuNjkgMjJMMTQuMjIgMjJMMTQuMjIgMTMuNDdMMTYuMTQgMTMuNDdMMTguNjAgMjAuMDFMMjEuMDYgMTMuNDdMMjIuOTcgMTMuNDdMMjIuOTcgMjJMMjEuNDkgMjJMMjEuNDkgMTkuMTlMMjEuNjQgMTUuNDNMMTkuMTIgMjJMMTguMDYgMjJMMTUuNTUgMTUuNDNMMTUuNjkgMTkuMTlMMTUuNjkgMjJaTTI4LjQ5IDIyTDI2Ljk1IDIyTDMwLjE3IDEzLjQ3TDMxLjUwIDEzLjQ3TDM0LjczIDIyTDMzLjE4IDIyTDMyLjQ5IDIwLjAxTDI5LjE4IDIwLjAxTDI4LjQ5IDIyWk0zMC44MyAxNS4yOEwyOS42MCAxOC44MkwzMi4wNyAxOC44MkwzMC44MyAxNS4yOFpNNDEuMTQgMjJMMzguNjkgMjJMMzguNjkgMTMuNDdMNDEuMjEgMTMuNDdRNDIuMzQgMTMuNDcgNDMuMjEgMTMuOTdRNDQuMDkgMTQuNDggNDQuNTcgMTUuNDBRNDUuMDUgMTYuMzMgNDUuMDUgMTcuNTJMNDUuMDUgMTcuNTJMNDUuMDUgMTcuOTVRNDUuMDUgMTkuMTYgNDQuNTcgMjAuMDhRNDQuMDggMjEuMDAgNDMuMTkgMjEuNTBRNDIuMzAgMjIgNDEuMTQgMjJMNDEuMTQgMjJaTTQwLjE3IDE0LjY2TDQwLjE3IDIwLjgyTDQxLjE0IDIwLjgyUTQyLjMwIDIwLjgyIDQyLjkzIDIwLjA5UTQzLjU1IDE5LjM2IDQzLjU2IDE3Ljk5TDQzLjU2IDE3Ljk5TDQzLjU2IDE3LjUyUTQzLjU2IDE2LjEzIDQyLjk2IDE1LjQwUTQyLjM1IDE0LjY2IDQxLjIxIDE0LjY2TDQxLjIxIDE0LjY2TDQwLjE3IDE0LjY2Wk01NS4wOSAyMkw0OS41MSAyMkw0OS41MSAxMy40N0w1NS4wNSAxMy40N0w1NS4wNSAxNC42Nkw1MS4wMCAxNC42Nkw1MS4wMCAxNy4wMkw1NC41MCAxNy4wMkw1NC41MCAxOC4xOUw1MS4wMCAxOC4xOUw1MS4wMCAyMC44Mkw1NS4wOSAyMC44Mkw1NS4wOSAyMlpNNjYuNzUgMjJMNjUuMjYgMjJMNjUuMjYgMTMuNDdMNzAuNjggMTMuNDdMNzAuNjggMTQuNjZMNjYuNzUgMTQuNjZMNjYuNzUgMTcuMjBMNzAuMTggMTcuMjBMNzAuMTggMTguMzhMNjYuNzUgMTguMzhMNjYuNzUgMjJaTTc0LjU3IDE4LjAwTDc0LjU3IDE4LjAwTDc0LjU3IDE3LjUyUTc0LjU3IDE2LjI4IDc1LjAyIDE1LjMyUTc1LjQ2IDE0LjM3IDc2LjI3IDEzLjg2UTc3LjA3IDEzLjM1IDc4LjExIDEzLjM1UTc5LjE2IDEzLjM1IDc5Ljk2IDEzLjg1UTgwLjc3IDE0LjM1IDgxLjIxIDE1LjI5UTgxLjY1IDE2LjIzIDgxLjY1IDE3LjQ4TDgxLjY1IDE3LjQ4TDgxLjY1IDE3Ljk2UTgxLjY1IDE5LjIxIDgxLjIyIDIwLjE2UTgwLjc5IDIxLjEwIDc5Ljk4IDIxLjYxUTc5LjE3IDIyLjEyIDc4LjEzIDIyLjEyTDc4LjEzIDIyLjEyUTc3LjA5IDIyLjEyIDc2LjI4IDIxLjYxUTc1LjQ3IDIxLjEwIDc1LjAyIDIwLjE3UTc0LjU4IDE5LjIzIDc0LjU3IDE4LjAwWk03Ni4wNiAxNy40Nkw3Ni4wNiAxNy45NlE3Ni4wNiAxOS4zNiA3Ni42MCAyMC4xM1E3Ny4xNSAyMC45MCA3OC4xMyAyMC45MEw3OC4xMyAyMC45MFE3OS4xMSAyMC45MCA3OS42NCAyMC4xNVE4MC4xNyAxOS40MCA4MC4xNyAxNy45Nkw4MC4xNyAxNy45Nkw4MC4xNyAxNy41MVE4MC4xNyAxNi4wOSA3OS42MyAxNS4zNFE3OS4xMCAxNC41OCA3OC4xMSAxNC41OEw3OC4xMSAxNC41OFE3Ny4xNSAxNC41OCA3Ni42MSAxNS4zM1E3Ni4wNyAxNi4wOSA3Ni4wNiAxNy40Nkw3Ni4wNiAxNy40NlpNODcuNjAgMjJMODYuMTIgMjJMODYuMTIgMTMuNDdMODkuMTIgMTMuNDdROTAuNTkgMTMuNDcgOTEuNDAgMTQuMTNROTIuMjAgMTQuNzkgOTIuMjAgMTYuMDVMOTIuMjAgMTYuMDVROTIuMjAgMTYuOTAgOTEuNzkgMTcuNDhROTEuMzcgMTguMDYgOTAuNjQgMTguMzdMOTAuNjQgMTguMzdMOTIuNTUgMjEuOTJMOTIuNTUgMjJMOTAuOTYgMjJMODkuMjUgMTguNzFMODcuNjAgMTguNzFMODcuNjAgMjJaTTg3LjYwIDE0LjY2TDg3LjYwIDE3LjUyTDg5LjEyIDE3LjUyUTg5Ljg3IDE3LjUyIDkwLjMwIDE3LjE1UTkwLjcyIDE2Ljc3IDkwLjcyIDE2LjExTDkwLjcyIDE2LjExUTkwLjcyIDE1LjQzIDkwLjMzIDE1LjA1UTg5Ljk0IDE0LjY4IDg5LjE2IDE0LjY2TDg5LjE2IDE0LjY2TDg3LjYwIDE0LjY2WiIgZmlsbD0iI0ZGRkZGRiIvPjxwYXRoIGNsYXNzPSJzdmdfX3RleHQiIGQ9Ik0xMTkuOTQgMjJMMTE3LjUxIDIyTDEyMS4yMiAxMy42MEwxMjMuNTYgMTMuNjBMMTI3LjI4IDIyTDEyNC44MSAyMkwxMjQuMTUgMjAuMzdMMTIwLjYwIDIwLjM3TDExOS45NCAyMlpNMTIyLjM3IDE1LjkzTDEyMS4yOSAxOC42MUwxMjMuNDUgMTguNjFMMTIyLjM3IDE1LjkzWk0xMzMuNzYgMjJMMTMxLjQzIDIyTDEzMS40MyAxMy42MEwxMzMuMzkgMTMuNjBMMTM3LjEwIDE4LjA3TDEzNy4xMCAxMy42MEwxMzkuNDIgMTMuNjBMMTM5LjQyIDIyTDEzNy40NyAyMkwxMzMuNzYgMTcuNTJMMTMzLjc2IDIyWk0xNDQuMDAgMjEuMjRMMTQ0LjAwIDIxLjI0TDE0NC43OCAxOS40OVExNDUuMzQgMTkuODYgMTQ2LjA5IDIwLjA5UTE0Ni44MyAyMC4zMiAxNDcuNTUgMjAuMzJMMTQ3LjU1IDIwLjMyUTE0OC45MiAyMC4zMiAxNDguOTIgMTkuNjRMMTQ4LjkyIDE5LjY0UTE0OC45MiAxOS4yOCAxNDguNTMgMTkuMTFRMTQ4LjE0IDE4LjkzIDE0Ny4yOCAxOC43NEwxNDcuMjggMTguNzRRMTQ2LjMzIDE4LjUzIDE0NS42OSAxOC4zMFExNDUuMDUgMTguMDYgMTQ0LjYwIDE3LjU1UTE0NC4xNSAxNy4wMyAxNDQuMTUgMTYuMTZMMTQ0LjE1IDE2LjE2UTE0NC4xNSAxNS4zOSAxNDQuNTcgMTQuNzdRMTQ0Ljk4IDE0LjE1IDE0NS44MiAxMy43OVExNDYuNjUgMTMuNDMgMTQ3Ljg2IDEzLjQzTDE0Ny44NiAxMy40M1ExNDguNjkgMTMuNDMgMTQ5LjQ5IDEzLjYyUTE1MC4zMCAxMy44MCAxNTAuOTEgMTQuMTdMMTUwLjkxIDE0LjE3TDE1MC4xOCAxNS45M1ExNDguOTggMTUuMjggMTQ3Ljg1IDE1LjI4TDE0Ny44NSAxNS4yOFExNDcuMTQgMTUuMjggMTQ2LjgyIDE1LjQ5UTE0Ni41MCAxNS43MCAxNDYuNTAgMTYuMDRMMTQ2LjUwIDE2LjA0UTE0Ni41MCAxNi4zNyAxNDYuODggMTYuNTRRMTQ3LjI2IDE2LjcxIDE0OC4xMSAxNi44OUwxNDguMTEgMTYuODlRMTQ5LjA3IDE3LjEwIDE0OS43MCAxNy4zM1ExNTAuMzMgMTcuNTYgMTUwLjgwIDE4LjA3UTE1MS4yNiAxOC41OCAxNTEuMjYgMTkuNDZMMTUxLjI2IDE5LjQ2UTE1MS4yNiAyMC4yMSAxNTAuODQgMjAuODNRMTUwLjQyIDIxLjQ0IDE0OS41OCAyMS44MFExNDguNzQgMjIuMTcgMTQ3LjU0IDIyLjE3TDE0Ny41NCAyMi4xN1ExNDYuNTIgMjIuMTcgMTQ1LjU2IDIxLjkyUTE0NC42MCAyMS42NyAxNDQuMDAgMjEuMjRaTTE1OC4yMiAyMkwxNTUuODQgMjJMMTU1Ljg0IDEzLjYwTDE1OC4yMiAxMy42MEwxNTguMjIgMjJaTTE2Ny45MyAyMkwxNjMuMzkgMjJMMTYzLjM5IDEzLjYwTDE2Ny42OSAxMy42MFExNjkuMzAgMTMuNjAgMTcwLjE0IDE0LjE5UTE3MC45OCAxNC43OSAxNzAuOTggMTUuNzlMMTcwLjk4IDE1Ljc5UTE3MC45OCAxNi4zOSAxNzAuNjggMTYuODdRMTcwLjM5IDE3LjM0IDE2OS44NSAxNy42MkwxNjkuODUgMTcuNjJRMTcwLjU3IDE3Ljg3IDE3MC45NyAxOC40MVExNzEuMzggMTguOTQgMTcxLjM4IDE5LjcwTDE3MS4zOCAxOS43MFExNzEuMzggMjAuODAgMTcwLjQ5IDIxLjQwUTE2OS42MSAyMiAxNjcuOTMgMjJMMTY3LjkzIDIyWk0xNjUuNzQgMTguNThMMTY1Ljc0IDIwLjI4TDE2Ny43NCAyMC4yOFExNjguOTggMjAuMjggMTY4Ljk4IDE5LjQzTDE2OC45OCAxOS40M1ExNjguOTggMTguNTggMTY3Ljc0IDE4LjU4TDE2Ny43NCAxOC41OEwxNjUuNzQgMTguNThaTTE2NS43NCAxNS4zMUwxNjUuNzQgMTYuOTRMMTY3LjM3IDE2Ljk0UTE2OC41NyAxNi45NCAxNjguNTcgMTYuMTJMMTY4LjU3IDE2LjEyUTE2OC41NyAxNS4zMSAxNjcuMzcgMTUuMzFMMTY3LjM3IDE1LjMxTDE2NS43NCAxNS4zMVpNMTgyLjQ4IDIyTDE3Ni4xMCAyMkwxNzYuMTAgMTMuNjBMMTc4LjQ4IDEzLjYwTDE3OC40OCAyMC4xMUwxODIuNDggMjAuMTFMMTgyLjQ4IDIyWk0xOTMuNjUgMjJMMTg2LjkwIDIyTDE4Ni45MCAxMy42MEwxOTMuNDkgMTMuNjBMMTkzLjQ5IDE1LjQ0TDE4OS4yNiAxNS40NEwxODkuMjYgMTYuODVMMTkyLjk5IDE2Ljg1TDE5Mi45OSAxOC42M0wxODkuMjYgMTguNjNMMTg5LjI2IDIwLjE3TDE5My42NSAyMC4xN0wxOTMuNjUgMjJaIiBmaWxsPSIjRkZGRkZGIiB4PSIxMTcuMzMiLz48L3N2Zz4=)](https://forthebadge.com)

Ansible is nowadays the de-facto DevOps technology for IT automation. Ansible modules and playbooks can automate a wide variety of tasks across many devices of multiple vendors. From services management and deployment, to more complex orchestration, Ansible can handle massive operations throughout a network. 

Cisco technologies are no exception. This repository includes an Ansible module developed in Python for automating the uploading and installation of general purpose COP files in Cisco CallManager (CUCM) servers for adding extra functionalities, such as add-ons, language packs and beyond. Although this process can be done manually via the Web UI or even through SSH CLI, it is very prone to human errors, plus not compatible with massive deployments. Hence the purpose of this Ansible module.

# Setting up the environment

- Ansible must be installed in the host OS
- Python v.3.6.9 must be installed. This must be the only python version in the virtual environment or host OS
- Install the dependencies included in this repository with the following command:
```
pip install -r requirements.txt
```

- Copy the files of this repository in your local environment. Make sure that the playbook file is located in the same directory as the "library" folder.
- Prepare your hosts file with the CUCM servers of interest, as mentioned in the example "host" file of this repository: 
```
[mycallmanagers]
ansible_ssh_host=<your_ip_address> ansible_user=<your_ssh_username> ansible_ssh_pass=<your_ssh_password>
ansible_ssh_host=<your_ip_address> ansible_user=<your_ssh_username> ansible_ssh_pass=<your_ssh_password>
ansible_ssh_host=<your_ip_address> ansible_user=<your_ssh_username> ansible_ssh_pass=<your_ssh_password>
. . .
```

# Setting up the playbook

- Update the "cucm_cop_upload" playbook with the following information:
```
- name: CallManager COP Uploader
  hosts: mycallmanagers
  connection: local
  gather_facts: no
  tasks:
    - name: COP upload
      cucm_cop_upload:
        CUCM_IP: "{{ansible_ssh_host}}"
        CUCM_SSH_USERNAME: "{{ansible_user}}"
        CUCM_SSH_PASSWORD: "{{ansible_ssh_pass}}"
        REMOTE_SERVER: "<FTP/SFTP server address>"
        REMOTE_USERNAME: "<FTP/SFTP server username>"
        REMOTE_PASSWORD: "<FTP/SFTP server password>"
        REMOTE_DIRECTORY: "<FTP/SFTP server COP file route>"
        REMOTE_SMTP: ''
        REMOTE_FILE: "<COP file name>"
        REMOTE_SERVER_TYPE: "FTP" or "SFTP"
        DO_REBOOT: True/False
        DO_LOGGING: True/False
      register: result
    - debug: var=result
```

Leave the fields of CUCM_IP, CUCM_SSH_USERNAME and CUCM_SSH_PASSWORD as mentioned in the playbook given that the token notation will extract the values of the specified CUCM hosts group as stated in the "hosts" file.

The following is a more detailed explanation of the rest of the fields in the playbook:

- REMOTE_SERVER: Adress of the FTP/SFTP server where the COP file is located
- REMOTE_USERNAME: Username of the FTP/SFTP server where the COP file is located
- REMOTE_PASSWORD: Password of the FTP/SFTP server where the COP file is located
- REMOTE_DIRECTORY: Directory of the FTP/SFTP server where the COP file is located
- REMOTE_SMTP: SMTP of the FTP/SFTP server where the COP file is located (optional)
- REMOTE_FILE: Name of the COP file to be uploaded and installed. The name must include the extension of the file (ex: .cop.sgn)
- REMOTE_SERVER_TYPE: Server type to connecto to (FTP/STFP)
- DO_REBOOT: Option to reboot the CallManager server once the COP installation is complete (True/False)
- DO_LOGGING: Option to do extensive login of the SSH interaction in a file stored locally (True/False)

# Running the Ansible module

In order to run the playbook, issue the following command:
```
ansible-playbook cop_playbook.yml'
```

In case python3 is not the only version installed in the host system, issue the following command:
```
ansible-playbook my_playbook.yaml -e 'ansible_python_interpreter=/usr/bin/python3'
```

See the README.md file in the "library" folder for more information regarding the Ansible module.

Crafted with :heart: by [Alfonso Sandoval - Cisco](https://linkedin.com/in/asandovalros)